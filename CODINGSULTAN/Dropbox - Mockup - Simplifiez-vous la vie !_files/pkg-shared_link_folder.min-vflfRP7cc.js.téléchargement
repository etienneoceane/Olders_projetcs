define("modules/clean/loggers/folder_preview_logger",["require","exports","tslib","modules/clean/ajax","modules/core/browser_detection","modules/core/browser","modules/constants/request","modules/clean/react/previews/constants","modules/clean/web_timing_logger","modules/clean/uuid"],(function(e,r,t,n,a,i,o,l,s,d){"use strict";var c,u;function f(e){return+!!e}function p(e){return JSON.stringify(t.__assign({},e,{has_cached_data:f(e.has_cached_data),folder_preview_timeline:JSON.stringify(e.folder_preview_timeline),subfolder_nav_tracking:f(e.subfolder_nav_tracking),web_timing_data:JSON.stringify(e.web_timing_data)}))}function _(e){var r=t.__assign({},e.extra),n=i.performance();if(null!=n){var a=n.timing;a&&a.fetchStart&&(r.time_to_first_byte=a.responseStart-a.fetchStart,r.web_timing_data=a)}return{device_type:e.deviceType,folder_preview_session_id:e.id,folder_ns_id:e.ns_id||0,web_request_id:e.web_request_id,extra:p(r)}}Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importStar(n),a=t.__importStar(a),i=t.__importStar(i),o=t.__importStar(o),(function(e){e.desktop="desktop",e.mobile="mobile",e.tablet="tablet"})(c=r.DeviceType||(r.DeviceType={})),(function(e){e.attempted="preview_attempted",e.renderSucceeded="render_succeeded",e.renderFailed="render_failed",e.ended="preview_session_ended",e.appDownloadInterstitialClose="app_download_interstitial_close",e.appDownloadInterstitialContinue="app_download_interstitial_continue",e.appDownloadInterstitialInstall="app_download_interstitial_install",e.appDownloadInterstitialView="app_download_interstitial_view",e.breadcrumbClicked="breadcrumb_clicked"})(u=r.EventType||(r.EventType={})),r.createSession=function(e){var r=void 0===e?{}:e,t=r.id,n=void 0===t?d.UUID.v4({allowInsecure:!0}):t,u=r.ns_id,f=void 0===u?0:u,p=r.deviceType,_=void 0===p?a.is_supported_mobile_browser()?c.mobile:a.is_tablet()?c.tablet:c.desktop:p,m=r.web_request_id,h=void 0===m?o.REQUEST_ID:m,v=r.source_action,g=void 0===v?l.PreviewSourceAction.Visit:v,w=r.subfolder_nav_tracking,y=r.has_cached_data,b=r.use_odyssey,k=void 0!==b&&b;return{id:n,ns_id:f,web_request_id:h,deviceType:_,extra:{start_time:g===l.PreviewSourceAction.Visit?s.start_time():i.now(),subfolder_nav_tracking:w,has_cached_data:y,source_action:g,folder_preview_timeline:{},use_odyssey:k}}},r.markPrimaryEvent=function(e){var r=e.extra;if(!r.primary_mark_ts){var t=i.now();r.primary_mark_ts=t;var n=r.start_time;n&&r.primary_mark_ts&&(r.time_to_primary_mark=r.primary_mark_ts-n)}},r.logEvent=function(e,r){var a=r.extra.folder_preview_timeline,o=i.now();if(!a.preview_session_ended_ts){switch(e){case u.attempted:if(a.preview_attempted_ts)return;a.preview_attempted_ts=o;break;case u.ended:if(a.preview_session_ended_ts)return;a.preview_session_ended_ts=o;break;case u.renderSucceeded:if(a.render_succeeded_ts)return;a.render_succeeded_ts=o;break;case u.renderFailed:if(a.render_failed_ts)return;a.render_failed_ts=o}return(function(e,r){return n.SilentBackgroundBeaconRequest({url:"/log/folder_preview",data:t.__assign({},_(r),{event_name:e})})})(e,r)}}})),define("modules/clean/photos/batching_thumb_store",["require","exports","tslib","modules/clean/photos/thumb_loading/batching_thumb_loader","modules/clean/photos/thumb_loading/generic_thumb_store","modules/constants/request"],(function(e,r,t,n,a,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),i=t.__importStar(i);r.default=function(e){var r=!(!e||!e.allow_http2)&&e.allow_http2,t=i.IS_HTTP2&&r,o=t?void 0:new n.BatchingThumbLoader;return new a.GenericThumbStore(o,!t)}})),define("modules/clean/photos/thumb_loading/batching_thumb_loader",["require","exports","modules/clean/photos/batch_thumb_loader","modules/clean/photos/thumb_loading/utils"],(function(e,r,t,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=(function(){function e(){this.batch_thumb_loader=new t.BatchThumbLoader({})}return e.prototype.get_request_id=function(){return this.batch_thumb_loader.vend_request_id()},e.prototype.load_image=function(e,r,t,n,a,i){this.batch_thumb_loader.queue_thumb(e,this._thumb_loaded.bind(this,{url:e,request_id:r,success:n,error:a,should_retry:i}),{onrequest:t,request_id:r}),window.setTimeout(this.batch_thumb_loader.flush.bind(this.batch_thumb_loader,10))},e.prototype._thumb_loaded=function(e,r){var t=e.url,a=(e.request_id,e.success),i=e.error,o=e.should_retry;r&&0===r.indexOf("data:")?a(r):n.load_individual_image(t,0,a,i,o)},e.prototype.cancel_thumb=function(e){this.batch_thumb_loader.cancel_thumb(e)},e})();r.BatchingThumbLoader=a})),define("modules/clean/prefetch/prefetch",["require","exports"],(function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getPrefetchData=function(e){var r=window[e];if(r)return(function(e){return new Promise((function(r,t){var n=e.getDataIfAvailable();n?n.payload?r(JSON.parse(n.payload)):t(n.error):e((function(e){return r(JSON.parse(e))}),t)}))})(r)}})),define("modules/clean/react/shared_link_folder/api",["require","exports","modules/clean/prefetch/prefetch","modules/clean/ajax"],(function(e,r,t,n){"use strict";function a(e){return{_mount_access_perms:e._mount_access_perms,filename:e.filename,href:e.href,is_dir:e.is_dir,ns_id:e.ns_id,open_in_app_data:e.open_in_app_data,shared_folder_id:e.shared_folder_id,sort_key:e.sort_key}}function i(e){return{url:e.url,displayName:e.displayName,downloadTestUrl:e.downloadTestUrl,ownerName:e.ownerName,ownerTeamName:e.ownerTeamName,ownerTeamLogo:e.ownerTeamLogo}}function o(e){return{canCopyToDropboxRoles:e.canCopyToDropboxRoles,canDownloadRoles:e.canDownloadRoles,canPrintRoles:e.canPrintRoles,canRemoveLinkUids:e.canRemoveLinkUids,canSyncToDropboxRoles:e.canSyncToDropboxRoles,canViewContextMenuRoles:e.canViewContextMenuRoles,canViewMetadataRoles:e.canViewMetadataRoles}}function l(e){return{itemId:e.itemId,linkKey:e.linkKey,linkType:e.linkType,secureHash:e.secureHash,subPath:e.subPath}}function s(e){for(var r,t=[],n=0,s=e.entries;n<s.length;n++){var d=s[n];d.is_dir?t.push(a(d)):t.push({is_dir:(r=d).is_dir,filename:r.filename,sort_key:r.sort_key,href:r.href,bytes:r.bytes,preview:r.preview,ns_id:r.ns_id,preview_type:r.preview_type?r.preview_type:null,sjid:r.sjid,ts:r.ts,thumbnail_url_tmpl:r.thumbnail_url_tmpl,file_id:r.file_id,revision_id:r.revision_id,is_symlink:!1})}var c=e.shared_link_infos.map(i),u=e.share_permissions.map(o),f=e.share_tokens.map(l);return{entries:t,folder:a(e.folder),folderSharedLinkInfo:i(e.folder_shared_link_info),folderSharePermission:o(e.folder_share_permission),folderShareToken:l(e.folder_share_token),hasMoreEntries:e.has_more_entries,nextRequestVoucher:e.next_request_voucher,sharedLinkInfos:c,sharePermissions:u,shareTokens:f,takedownRequestType:e.takedown_request_type}}function d(e,r,t){var a={link_key:e.linkKey,link_type:e.linkType,secure_hash:e.secureHash,sub_path:e.subPath||""};return r&&(a.voucher=r),new Promise((function(e,r){return n.WebRequest({type:"POST",url:"/list_shared_link_folder_entries",data:a,dataType:"json",success:function(r,n,a){if(t){var i=a.getResponseHeader("x-dropbox-request-id");t.end(i||void 0)}e(s(r))},error:function(e,t,n){r(new Error(n))}})}))}Object.defineProperty(r,"__esModule",{value:!0}),r.deserializePage=s,r.fetchPage=d,r.fetchPreviewAndSharingData=function(e){return d(e)},r.prefetchFirstPage=function(e){return(function(){var e=t.getPrefetchData("__REGISTER_SHARED_LINK_FOLDER_PRELOAD_HANDLER");if(e)return e.then(s)})()||d(e)},r.fetchNextPage=function(e,r){return d(e,r)}})),define("modules/clean/react/shared_link_folder/api_odyssey",["require","exports","tslib","modules/clean/prefetch/prefetch","modules/clean/react/shared_link_folder/api","modules/clean/filepath"],(function(e,r,t,n,a,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),i=t.__importStar(i);function o(e){for(var r=[],t=0,n=e.paginated?e.first_page.items:e.file_info;t<n.length;t++){var a=n[t];a.is_dir?r.push(l(a)):r.push(s(a))}return{entries:r,hasMoreEntries:e.paginated&&e.first_page.has_more_items,nextRequestVoucher:e.paginated?e.first_page.next_request_voucher:void 0}}function l(e){return{_mount_access_perms:e.mount_access_perms,filename:i.filename(e.fq_path),href:"",is_dir:!0,ns_id:e.ns_id,open_in_app_data:void 0,shared_folder_id:void 0,sort_key:[e.sort_key]}}function s(e){return{bytes:e.bytes,file_id:e.file_id,filename:i.filename(e.fq_path),href:"",is_dir:!1,is_symlink:e.is_symlink,ns_id:e.ns_id,revision_id:e.revision_id,sjid:e.sjid,sort_key:[e.sort_key],ts:e.ts}}r.deserializeOdysseyResponse=o,r.deserializeFolder=l,r.deserializeFile=s,r.prefetchFirstPage=function(e){return(function(){var e=n.getPrefetchData("__REGISTER_ODYSSEY_SHARED_LINK_FOLDER_PRELOAD_HANDLER");if(e)return e.then(o)})()||a.fetchPage(e)}})),define("modules/clean/react/shared_link_folder/app",["require","exports","tslib","external/lodash","react","redux","react-redux","modules/clean/cloud_docs/open_with_utils","modules/clean/loggers/folder_preview_logger","modules/clean/open_in_app/actions","modules/clean/previews/constants","modules/clean/react/async/loadable","modules/clean/react/file_viewer/data/actions","modules/clean/react/file_viewer/data/selectors","modules/clean/react/file_viewer/location_utils","modules/clean/react/location/with_location","modules/clean/react/file_viewer/url_utils","modules/clean/react/previews/constants","modules/clean/react/shared_link_folder/data/actions","modules/clean/react/shared_link_folder/data/store","modules/clean/react/shared_link_folder/page","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/python","modules/clean/web_timing_logger","modules/clean/storage","modules/clean/react/shared_link_folder/utils","modules/clean/react/shared_link_folder/data/selectors","modules/clean/csrf","modules/core/browser","modules/clean/react/file_viewer/utils"],(function(e,r,t,n,a,i,o,l,s,d,c,u,f,p,_,m,h,v,g,w,y,b,k,S,F,E,T,P,I,D,C){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importStar(n),a=t.__importDefault(a),F=t.__importStar(F);var M=n.memoize((function(){return new Promise((function(r,t){e(["modules/clean/react/file_viewer/collection_viewer"],r,t)})).then(t.__importStar)}));r.AsyncFileCollectionViewer=u.Loadable({loader:function(){return M().then((function(e){return e.FileCollectionViewer}))}});var L=function(e){return{label:e.filename,href:e.href}};function A(){var e=F.get_timer();return e.timeToInteractive()&&(e=F.get_timer("shared_link_folder_ajax")).initialize({requireTTI:!0,requireTTV:!0,url:"shared_link_folder_ajax"}),e}var O=(function(i){function o(e){var r,t=i.call(this,e)||this;t.handleOpenFile=function(e){e.preview_type&&e.preview_type===c.PreviewType.CloudDoc&&!l.isShortcut(e)?D.open_tab(e.href):t.previewDataPromise?t.previewDataPromise.then((function(){return h.openFile(e)})):h.openFile(e)},t.handleOpenFolder=function(e){t.previewDataPromise?t.previewDataPromise.then((function(){return T.openFolder(e)})):T.openFolder(e)};var n=b.Viewer.get_viewer(),a=n.work_user||n.personal_user,o=e.folderShareToken.secureHash,d=e.folderData,u=e.shouldFetchPreviewData;return t.state={folderHierarchyMap:(r={},r[o]=d?[d]:[],r),pageYOffset:0,previewSourceAction:v.PreviewSourceAction.Visit,user:a},t.folderPreviewSession=s.createSession({subfolder_nav_tracking:e.subfolderNavTracking,use_odyssey:u}),t.webTimer=A(),t}return t.__extends(o,i),o.prototype.componentWillMount=function(){if(this.webTimer.applicationStart(),this.props.openImmediatelyInApp)return this.openImmediatelyInApp()},o.prototype.componentWillUnmount=function(){this.unsubscribe()},o.prototype.componentWillReceiveProps=function(e){!this.props.viewingFilename&&e.viewingFilename&&this.setState({pageYOffset:window.pageYOffset}),this.props.viewingFilename!==e.viewingFilename&&this.setState({previewSourceAction:v.PreviewSourceAction.Click});var r=e.folder?e.folder.folder.ns_id:void 0;e.folderShareToken.secureHash!==this.props.folderShareToken.secureHash?(this.webTimer=A(),this.webTimer.restart(),this.folderPreviewSession=s.createSession({source_action:v.PreviewSourceAction.Click,subfolder_nav_tracking:e.subfolderNavTracking,has_cached_data:e.folder&&!!e.folder.entries.length,ns_id:r}),this.props.onFolderLoad(e.folderShareToken,this.webTimer)):this.props.viewingFilename&&!e.viewingFilename&&(this.folderPreviewSession=s.createSession({source_action:v.PreviewSourceAction.FileViewerExit,subfolder_nav_tracking:e.subfolderNavTracking,has_cached_data:!0,ns_id:r})),e.folder&&e.folder.folder&&T.setPageTitle(e.folder.folder.filename)},o.prototype.componentDidMount=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,r,a,i,o;return t.__generator(this,(function(t){switch(t.label){case 0:return e=this.props,r=e.file,a=e.folderShareToken,i=e.onFolderPrefetch,e.viewingFilename&&window.setTimeout(C.cleanupPrerenderPreview),a&&(this.previewDataPromise=i(a,r)),[4,k.waitForTTI()];case 1:return t.sent(),M(),[4,this.readFolderHierarchy()];case 2:return o=t.sent(),this.setState((function(e,r){var t=r.folderShareToken.secureHash;return{folderHierarchyMap:n.get(o,t)?o:e.folderHierarchyMap}})),[2]}}))}))},o.prototype.componentDidUpdate=function(e){var r=this.props.viewingFilename,n=this.state.pageYOffset;r!==e.viewingFilename&&(r||window.scrollTo(0,n));var a=e.folderShareToken.secureHash,i=this.props.folderShareToken.secureHash;a!==i&&this.setState((function(r,n){var o;if(!n.folder||!T.shouldUpdateFolderHierarchy(r.folderHierarchyMap,e.folderShareToken,n.folderShareToken))return{folderHierarchyMap:r.folderHierarchyMap};var l=n.folder.folder;return{folderHierarchyMap:t.__assign({},r.folderHierarchyMap,(o={},o[i]=r.folderHierarchyMap[a].concat([l]),o))}}),this.writeFolderHierarchy)},o.prototype.getUserStorageKey=function(){return t.__awaiter(this,void 0,void 0,(function(){var r,n;return t.__generator(this,(function(a){switch(a.label){case 0:return[4,new Promise((function(r,t){e(["sjcl"],r,t)})).then(t.__importStar)];case 1:return r=a.sent(),n=r.hash.sha256.hash(I.readCsrfToken()||""),[2,r.codec.base64.fromBits(n)]}}))}))},o.prototype.writeFolderHierarchy=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,r,n,a;return t.__generator(this,(function(t){switch(t.label){case 0:return r=(e=E.SessionStorage).set,n=["shared_folder_hierarchy"],a={},[4,this.getUserStorageKey()];case 1:return r.apply(e,n.concat([(a[t.sent()]=this.state.folderHierarchyMap,a)])),[2]}}))}))},o.prototype.readFolderHierarchy=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,r,a;return t.__generator(this,(function(t){switch(t.label){case 0:return r=(e=n).get,a=[E.SessionStorage.get("shared_folder_hierarchy")],[4,this.getUserStorageKey()];case 1:return[2,r.apply(e,a.concat([t.sent()]))]}}))}))},o.prototype.openImmediatelyInApp=function(){var e=this.props.folder;if(e)try{e.folder.open_in_app_data&&d.openImmediately(e.folder.open_in_app_data)}catch(e){}},o.prototype.render=function(){var e=this.props,t=e.accountMenuOptions,i=e.appDownloadInterstitialDismissed,o=e.file,l=e.files,s=e.fileViewOrigin,d=e.fileViewTarget,c=e.folder,u=e.onAppDownloadInterstitialDismissed,f=e.outOfQuota,p=e.shouldForceListMode,_=e.showSyncCoachmark,m=e.subfolders,g=e.viewingFilename,w=this.state,b=w.folderHierarchyMap,k=w.user,F=w.previewSourceAction,E=n.get(b,this.props.folderShareToken.secureHash,[]).map(L);if(g&&o){var P=[],I=[],D=[],C=[];return Array.isArray(l)&&l.length?l.forEach((function(e,r){I.push(e.shareToken),D.push(e.sharedLinkInfo),P.push(e.sharePermission),C.push(e.file)})):(C=[o.file],P=[o.sharePermission],I=[o.shareToken],D=[o.sharedLinkInfo]),a.default.createElement(r.AsyncFileCollectionViewer,{canClose:!0,className:"no-background",file:o.file,files:C,fileViewOrigin:s,fileViewTarget:d,fileViewAction:S.FileViewActionType.CLICK,initialPreviewSourceContext:v.PreviewSourceContext.SharedLinkFolder,initialPreviewSourceAction:F,skipOuterRouting:!0,sharedLinkInfos:D,sharePermissions:P,shareTokens:I,titleBarCloseUrl:h.getCurrentFolderHref(),onCloseViewer:h.closeFile,user:k})}if(!c)return null;var M=c.shareToken,A=c.sharedLinkInfo,O=c.folder,N=c.sharePermission,R=c.hasMore,H=c.takedownRequestType,x={files:Array.isArray(l)?l.map((function(e){return e.file})):[],folders:Array.isArray(m)?m.map((function(e){return e.folder})):[]};return a.default.createElement(y.SharedLinkFolderPage,{accountMenuOptions:t,appDownloadInterstitialDismissed:i,breadcrumbs:E,contents:x,folder:O,folderPreviewSession:this.folderPreviewSession,folderSharePermission:N,folderShareToken:M,folderSharedLinkInfo:A,hasMore:R,onAppDownloadInterstitialDismissed:u,onFileOpen:this.handleOpenFile,onFolderOpen:this.handleOpenFolder,onListModeDisable:T.disableListMode,onListModeEnable:T.enableListMode,outOfQuota:f,shouldForceListMode:p,showSyncCoachmark:_,takedownRequestType:H,user:k,webTimer:this.webTimer})},o.defaultProps={subfolderNavTracking:!1},o})(a.default.PureComponent);r._SharedLinkFolderApp=O;var N=o.connect((function(e,r){var t=p.getAppDownloadInterstitial(e);void 0===t&&(t=r.appDownloadInterstitialDismissed);var n=r.folderShareToken.secureHash,a=r.viewingFilename;return{appDownloadInterstitialDismissed:t,file:P.getSharedFilePackageByFilenameForFolderPath(e,n,a||""),folder:P.getFolderByPath(e,n),files:P.getSharedFilePackagesForFolderPath(e,n),subfolders:P.getSubfoldersForFolderPath(e,n)}}),(function(e,r){var t=r.shouldFetchPreviewData;return i.bindActionCreators({onAppDownloadInterstitialDismissed:f.dismissAppDownloadInterstitial,onFolderLoad:g.fetchFolder,onFolderPrefetch:t?g.prefetchFolderFromOdyssey:g.prefetchFolder},e)}))(O),R=m.withLocation(N,(function(e){return{folderShareToken:T.getFolderShareTokenFromLocation(e),viewingFilename:_.getFilenameFromLocation(e),shouldForceListMode:"lst"in e.query,subfolderNavTracking:"subfolder_nav_tracking"in e.query}})),H=(function(e){function r(r){var t=e.call(this,r)||this;return t.store=w.getStoreForSharedLinkFolder(),w.hydrateStore(t.store,{initialFolder:t.props.folderData,initialPreview:t.props.preview,folderSharedLinkInfo:t.props.folderSharedLinkInfo,folderSharePermission:t.props.folderSharePermission,folderShareToken:t.props.folderShareToken}),t}return t.__extends(r,e),r.prototype.render=function(){return a.default.createElement(o.Provider,{store:this.store},a.default.createElement(R,t.__assign({},this.props)))},r})(a.default.Component);r.SharedLinkFolderApp=H})),define("modules/clean/react/shared_link_folder/data/actions",["require","exports","tslib","modules/clean/file_store/actions","modules/clean/react/shared_link_folder/api","modules/clean/react/shared_link_folder/api_odyssey","modules/clean/react/shared_link_folder/data/types","modules/clean/file_store/utils","modules/clean/previews/data/actions","modules/clean/redux/types"],(function(e,r,t,n,a,i,o,l,s,d){"use strict";function c(e,r){var n=(function(e){return e?{file:e.file,fileMetadata:t.__rest(e,["file"])}:{file:void 0,fileMetadata:void 0}})(r),a=n.file,i=n.fileMetadata,s=a&&l.getFileStoreId(a);return{type:o.Actions.HydrateSharedFolder,payload:{fileId:s,fileMetadata:i,folderPackage:t.__assign({},e,{entries:e.entries.length?e.entries:s?[{type:"file",id:s}]:[]})}}}function u(e,r){for(var t=[],n={},a=0,i=r;a<i.length;a++){var s=i[a];if(s.is_dir){var d=s.filename;t.push({type:"folder",id:d}),n[d]={folder:s,entries:[],hasMore:!0}}else t.push({type:"file",id:l.getFileRevisionId(s)})}return{type:o.Actions.HydrateEntries,payload:{secureHash:e,entries:t,folderPackageMap:n}}}function f(e){return{type:o.Actions.FetchPageRequest,payload:e}}function p(e,r){return{type:o.Actions.FetchPageSuccess,payload:{fileMetadata:e,folderPackage:r}}}function _(e,r){return function t(i,s){void 0===s&&(s=0);var d=(function(e,r,t){var n;void 0===t&&(t=0);var a=e.entries,i=e.hasMoreEntries,s=e.sharedLinkInfos,d=e.sharePermissions,c=e.shareTokens,u=e.takedownRequestType,f={},p=((n={})[r]={entries:[],fromIndex:t,hasMore:i,takedownRequestType:u,folder:e.folder,sharedLinkInfo:e.folderSharedLinkInfo,sharePermission:e.folderSharePermission,shareToken:e.folderShareToken},n),_=[];return a.forEach((function(e,t){if(o.isFile(e)){var n=l.getFileStoreId(e);_.push(e),f[n]={sharedLinkInfo:s[t],sharePermission:d[t],shareToken:c[t]},p[r].entries.push({type:"file",id:n})}else{var a=c[t].secureHash;p[r].entries.push({type:"folder",id:a}),p[a]={folder:e,fromIndex:0,hasMore:!0,sharedLinkInfo:s[t],sharePermission:d[t],shareToken:c[t]}}})),{files:_,fileMetadata:f,folderPackage:p}})(i,r.secureHash,s),c=d.files,u=d.fileMetadata,f=d.folderPackage;e(n.putFiles(c)),e(p(u,f)),i.hasMoreEntries&&i.nextRequestVoucher&&a.fetchNextPage(r,i.nextRequestVoucher).then((function(e){return t(e,s+i.entries.length)}))}}function m(e,r){return function(t){var a=r.entries,i=r.sharedLinkInfos,c=r.sharePermissions,u=r.shareTokens;if(a){var f=[],p={},_={},m=[];a.forEach((function(e,r){if(o.isFile(e)){var t=l.getFileStoreId(e);p[t]={sharedLinkInfo:i[r],sharePermission:c[r],shareToken:u[r]},f.push(e),m.push({type:"file",id:l.getFileRevisionId(e)})}else{var n=u[r].secureHash;_[n]={entries:[],folder:e,fromIndex:0,hasMore:!0,sharedLinkInfo:i[r],sharePermission:c[r],shareToken:u[r]},m.push({type:"folder",id:n})}})),t(n.putFiles(f)),t(s.updatePreviewData(s.buildPreviewData(f,d.ApiClientStatus.Success))),t({type:o.Actions.HydratePreviewAndSharingData,payload:{parentSecureHash:e,parentFolderEntries:m,fileMetadataMap:p,folderPackageMap:_}})}}}Object.defineProperty(r,"__esModule",{value:!0}),a=t.__importStar(a),i=t.__importStar(i),r.hydrateSharedFolderAndFile=function(e,r){return function(t){r&&t(n.putFile(r.file)),t(c(e,r))}},r.hydrateEntries=u,r.fetchPageSuccess=p,r.prefetchFolder=function(e,r){return function(r){r(f(e.secureHash));var t=a.prefetchFirstPage(e);return t.then(_(r,e)),t}},r.prefetchFolderFromOdyssey=function(e,r){return function(t){var c=a.fetchPreviewAndSharingData(e);return t(f(e.secureHash)),i.prefetchFirstPage(e).then((function(a){var i=(function(e,r){var t=e.entries,n=r?r.file:void 0;return{files:t.filter(o.isFile).map((function(e){return n&&l.areFilesEqual(n,e)?n:e})),entries:t}})(a,r),f=i.files,p=i.entries;t(n.putFiles(f)),t(s.updatePreviewData(s.buildPreviewData(f,d.ApiClientStatus.Request))),t(u(e.secureHash,p)),c.then((function(r){t(m(e.secureHash,r)),_(t,e)(r)}))})),c}},r.fetchFolder=function(e,r){return function(t){return t(f(e.secureHash)),a.fetchPage(e,void 0,r).then(_(t,e))}},r.hydratePreviewAndSharingData=m})),define("modules/clean/react/shared_link_folder/data/reducer",["require","exports","tslib","external/lodash","modules/clean/react/shared_link_folder/data/types","modules/clean/react/shared_link_folder/utils"],(function(e,r,t,n,a,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importStar(n);var o={fileMetadata:{},folderPackage:{}};r.sharedLinkFolderReducer=function(e,r){var l,s,d,c,u;switch(void 0===e&&(e=o),r.type){case a.Actions.FetchPageRequest:var f=r.payload,p=e.folderPackage[f];return p?t.__assign({},e,{folderPackage:t.__assign({},e.folderPackage,(l={},l[f]=t.__assign({},p,{hasMore:!0}),l))}):e;case a.Actions.HydrateSharedFolder:var _=r.payload,m=_.fileId,h=_.fileMetadata,v=(f=(b=_.folderPackage).shareToken.secureHash,null!=m?((s={})[m]=h,s):{});return t.__assign({},e,{fileMetadata:t.__assign({},e.fileMetadata,v),folderPackage:t.__assign({},e.folderPackage,(d={},d[f]=t.__assign({},b,{hasMore:!0}),d))});case a.Actions.HydrateEntries:var g=r.payload,w=(f=g.secureHash,g.entries),y=g.folderPackageMap,b=e.folderPackage[f];return t.__assign({},e,{folderPackage:t.__assign({},e.folderPackage,y,(c={},c[f]=t.__assign({},b,{entries:w}),c))});case a.Actions.FetchPageSuccess:var k=r.payload,S=(h=k.fileMetadata,k.folderPackage),F={};return Object.keys(S).forEach((function(r){var n=e.folderPackage[r]||{},a=S[r],o=a.fromIndex,l=t.__rest(a,["fromIndex"]);F[r]=t.__assign({},n,l,{entries:i.mergeFolderEntries(n.entries,l.entries,o,!l.hasMore)})})),t.__assign({},e,{fileMetadata:t.__assign({},e.fileMetadata,h),folderPackage:t.__assign({},e.folderPackage,F)});case a.Actions.HydratePreviewAndSharingData:var E=r.payload,T=E.fileMetadataMap,P=(y=E.folderPackageMap,E.parentSecureHash),I=E.parentFolderEntries,D=n.values(y).map((function(e){return e.folder.filename})),C=Object.keys(e.folderPackage).filter((function(e){return-1===D.indexOf(e)})).reduce((function(r,t){return r[t]=e.folderPackage[t],r}),{});return t.__assign({},e,{fileMetadata:t.__assign({},e.fileMetadata,T),folderPackage:t.__assign({},C,y,(u={},u[P]=t.__assign({},e.folderPackage[P],{entries:I}),u))})}return e}})),define("modules/clean/react/shared_link_folder/data/selectors",["require","exports","tslib","external/lodash","modules/clean/redux/namespaces","modules/clean/file_store/selectors"],(function(e,r,t,n,a,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importStar(n);var o=function(e){return e[a.SHARED_LINK_FOLDER_NAMESPACE_KEY]};r.getFolderByPath=function(e,r){return o(e).folderPackage[r]};var l=function(e,t){var n=r.getFolderByPath(e,t);return n?n.entries.filter((function(e){return"file"===e.type})).map((function(e){return e.id})):[]};function s(e,r){var n=i.getFile(e,r);if(n){var a=(function(e,r){return o(e).fileMetadata[r]})(e,r);return t.__assign({},a,{file:n})}}r.getSubfoldersForFolderPath=function(e,t){var n=r.getFolderByPath(e,t);if(n)return n.entries.filter((function(e){return"folder"===e.type})).map((function(r){return(function(e,r){return o(e).folderPackage[r]})(e,r.id)}))},r.getSharedFilePackagesForFolderPath=function(e,r){return l(e,r).map((function(r){return s(e,r)})).filter(Boolean)},r.getSharedFilePackageByFilenameForFolderPath=function(e,r,t){var a=(function(e,r,t){if(t){var a=l(e,r);return n.find(a,(function(r){var n=i.getFile(e,r);return void 0!==n&&n.filename===t}))}})(e,r,t);if(a)return s(e,a)}})),define("modules/clean/react/shared_link_folder/data/store",["require","exports","tslib","external/lodash","modules/clean/file_store/reducer","modules/clean/react/file_viewer/data/reducer","modules/clean/react/shared_link_folder/data/actions","modules/clean/react/shared_link_folder/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],(function(e,r,t,n,a,i,o,l,s,d){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importStar(n),r.getStoreForSharedLinkFolder=n.once((function(){var e,r=((e={})[d.FILE_NAMESPACE_KEY]=a.fileNamespaceReducer,e[d.FILE_VIEWER_NAMESPACE_KEY]=i.fileViewerReducer,e[d.SHARED_LINK_FOLDER_NAMESPACE_KEY]=l.sharedLinkFolderReducer,e);return s.getStoreAndRegisterReducers(r)})),r.hydrateStore=function(e,r){var t=r.initialPreview,n={folder:r.initialFolder,sharedLinkInfo:r.folderSharedLinkInfo,sharePermission:r.folderSharePermission,shareToken:r.folderShareToken,hasMore:!0,entries:[]};e.dispatch(o.hydrateSharedFolderAndFile(n,t))}})),define("modules/clean/react/shared_link_folder/data/types",["require","exports"],(function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isFile=function(e){return!e.is_dir},(function(e){e.HydrateSharedFolder="SHARED_FOLDER/HYDRATE",e.HydrateEntries="SHARED_FOLDER/HYDRATE_ENTRIES",e.HydratePreviewAndSharingData="SHARED_FOLDER/HYDRATE_PREVIEW_AND_SHARING_DATA",e.FetchPageSuccess="SHARED_FOLDER/FETCH_SUCCESS",e.FetchPageRequest="SHARED_FOLDER/FETCH_REQUEST"})(r.Actions||(r.Actions={}))})),define("modules/clean/react/shared_link_folder/folder_icon",["require","exports","tslib","react","modules/clean/react/shared_link_folder/utils","spectrum/icon_content","modules/clean/react/icon/icon_helper"],(function(e,r,t,n,a,i,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importDefault(n),r.SharedLinkFolderFolderIcon=function(e){var r=e.className,t=e.folder,l=e.size;return n.default.createElement(i.IconContent,{className:r,name:o.spectrumFolderIcon({size:l,isConfidential:a.isNoAccessFolder(t)})})}})),define("modules/clean/react/shared_link_folder/folder_title",["require","exports","tslib","react","modules/constants/trademark","modules/core/uri","modules/core/i18n","modules/clean/react/shared_link_folder/utils","modules/clean/react/async/loadable"],(function(e,r,t,n,a,i,o,l,s){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importDefault(n);var d=s.Loadable({loader:function(){return new Promise((function(r,t){e(["modules/clean/react/breadcrumb/trail"],r,t)})).then(t.__importStar).then((function(e){return e.BreadcrumbTrail}))}}),c=(function(e){function a(){var r=null!==e&&e.apply(this,arguments)||this;return r.handleCrumbClick=function(e,t,n){var a=r.props.onCrumbClick;e.preventDefault(),l.navigateToFolderHref(t.href),a&&a(n)},r}return t.__extends(a,e),a.prototype.render=function(){var e=this.props,a=e.breadcrumbs,i=e.ownerName,o=e.ownerTeamLogo,l=e.ownerTeamName,s=e.title;return n.default.createElement("div",{className:"sl-folder-title"},a&&a.length>0?n.default.createElement(d,t.__assign({},(function(e){var r,t;return e.length<=2?r=e:(r=e.slice(e.length-1),t=e.slice(0,e.length-1)),{inlineCrumbs:r,overflowCrumbs:t}})(a),{onChange:this.handleCrumbClick})):s,l?n.default.createElement(r.ContentOwner,{ownerName:i,ownerTeamName:l,ownerTeamLogo:o}):null)},a})(n.default.PureComponent);r.FolderTitle=c;var u=new i.URI({path:"/business",query:{src:"schmodel"}}).toString();r.ContentOwner=function(e){var r=e.ownerName,t=e.ownerTeamName,i=e.ownerTeamLogo;return n.default.createElement("div",{className:"sl-subtitle"},null!=r?o._("from %(owner)s (%(team)s)").format({owner:r,team:t}):o._("from %(team)s").format({team:t}),null!=i?n.default.createElement("span",null," ","via ",n.default.createElement("a",{href:u},a.TRADEMARK_BUSINESS)):null)}})),define("modules/clean/react/shared_link_folder/grid",["require","exports","tslib","react","classnames","modules/clean/em_string","modules/clean/previews/constants","modules/clean/react/icon/icon_helper","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/file_viewer/url_utils","modules/clean/react/thumbnail","spectrum/tooltip","modules/core/i18n"],(function(e,r,t,n,a,i,o,l,s,d,c,u,f){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importDefault(n),a=t.__importDefault(a);function p(e){var r=e.label,t=e.filename,a=n.default.createElement("span",{className:"sl-grid-filename"},r);return t===r?a:n.default.createElement(u.Tooltip,{positioning:"below",tooltipContent:t,wrapperClassName:"sl-grid-tooltip-wrapper"},a)}function _(e){var r=e.entry,t=e.onFolderOpen,a=e.onFileOpen,o=i.Emstring.em_snippet(r.filename,16);return r.is_dir?n.default.createElement(h,{folder:r,label:o,onOpen:t}):n.default.createElement(m,{file:r,label:o,onOpen:a})}r.FileTitle=p,r.SharedLinkFolderGrid=function(e){var r=e.entries,t=e.onFileOpen,a=e.onFolderOpen;return n.default.createElement("div",{className:"sl-grid"},n.default.createElement("div",{className:"sl-grid-header clearfix"},n.default.createElement("div",{className:"sl-grid-header-column sl-grid-header-column--sort"},f._("Sorted by name"))),n.default.createElement("ol",{className:"sl-grid-body"},r.map((function(e){return n.default.createElement("li",{className:"sl-grid-cell",key:e.filename},n.default.createElement(_,{entry:e,onFolderOpen:a,onFileOpen:t}))}))))};var m=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.handleClick=d.linkClickHandler((function(e){e.preventDefault();var t=r.props,n=t.file;(0,t.onOpen)(n)})),r}return t.__extends(r,e),r.prototype.isVideo=function(){return this.props.file.preview_type===o.PreviewType.Video},r.prototype.render=function(){var e=this.props,r=e.file,t=e.label,i=a.default("sl-link sl-link--file",{"sl-link--disabled":""===r.href});return n.default.createElement("a",{href:r.href,onClick:this.handleClick,className:i},n.default.createElement("div",{className:"sl-grid-thumbnail-container"},n.default.createElement(c.ThumbnailIcon,{alt:r.filename,className:"sl-grid-thumbnail",file:r,iconSize:l.SpectrumIconSize.Large}),this.isVideo()?n.default.createElement("div",{className:"sl-video-watermark"}):null),n.default.createElement(p,{label:t,filename:r.filename}))},r})(n.default.PureComponent);r.FileCell=m;var h=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.handleClick=d.linkClickHandler((function(e){e.preventDefault();var t=r.props,n=t.folder;(0,t.onOpen)(n)})),r}return t.__extends(r,e),r.prototype.render=function(){var e=this.props,r=e.folder,t=e.label,i=a.default("sl-link sl-link--folder",{"sl-link--disabled":""===r.href});return n.default.createElement("a",{href:r.href,onClick:this.handleClick,className:i},n.default.createElement("div",{className:"sl-grid-thumbnail-container"},n.default.createElement(s.SharedLinkFolderFolderIcon,{className:"sl-grid-thumbnail",folder:r,size:l.SpectrumIconSize.Large})),n.default.createElement(p,{label:t,filename:r.filename}))},r})(n.default.PureComponent);r.FolderCell=h})),define("modules/clean/react/shared_link_folder/list",["require","exports","tslib","react","classnames","spectrum/table","spectrum/media_table","modules/clean/datetime","modules/clean/em_string","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/thumbnail","modules/core/i18n","modules/core/uri","modules/clean/react/size_class/constants","modules/clean/react/file_viewer/url_utils"],(function(e,r,t,n,a,i,o,l,s,d,c,u,f,p,_){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importDefault(n),a=t.__importDefault(a);function m(e){var r=e.entry,t=e.sizeClass,a=e.onFolderOpen,i=e.onFileOpen;return r.is_dir?n.default.createElement(v,{folder:r,sizeClass:t,onOpen:a}):n.default.createElement(g,{file:r,sizeClass:t,onOpen:i})}function h(e){var r=e.icon,t=e.lastModified,i=e.name,d=e.sizeClass,c=e.onClick,u=e.href,f=_.linkClickHandler((function(e){e.preventDefault(),"function"==typeof c&&c()})),m=a.default("sl-list-row",{"sl-list-row--disabled":""===u});return n.default.createElement(o.MediaRow,{className:m},n.default.createElement(o.MediaCell,{className:"sl-list-column--filename",icon:r,title:s.Emstring.em_snippet(i,40)},n.default.createElement("a",{href:u,"aria-label":i,onClick:f})),d!==p.SizeClass.Small?n.default.createElement(o.MediaCell,{className:"sl-list-column--modified",title:t?l.format_date(t,l.localized_datetime_format):"--"}):null)}function v(e){var r=e.folder,t=e.sizeClass,a=e.onOpen,i="";""!==r.href&&(i=f.URI.parse(r.href).updateQuery({lst:""}).toString());return n.default.createElement(h,{icon:n.default.createElement(d.SharedLinkFolderFolderIcon,{className:"sl-list-icon",folder:r}),href:i,name:r.filename,onClick:function(){return a(r)},sizeClass:t})}function g(e){var r=e.file,t=e.sizeClass,a=e.onOpen;return n.default.createElement(h,{icon:n.default.createElement(c.ThumbnailIcon,{alt:r.filename,className:"sl-list-icon",file:r}),lastModified:new Date(1e3*r.ts),name:r.filename,href:r.href,onClick:function(){return a(r)},sizeClass:t})}r.SharedLinkFolderList=function(e){var r=e.entries,t=e.sizeClass,a=e.onFileOpen,o=e.onFolderOpen;return n.default.createElement(i.Table,{className:"sl-list-container"},n.default.createElement(i.TableHead,null,n.default.createElement(i.TableHeadCell,null,u._("Name")),t!==p.SizeClass.Small?n.default.createElement(i.TableHeadCell,null,u._("Modified",{comment:"label for last modified time"})):null),n.default.createElement(i.TableBody,null,r.map((function(e){return n.default.createElement(m,{key:e.filename,entry:e,sizeClass:t,onFileOpen:a,onFolderOpen:o})}))))}})),define("modules/clean/react/shared_link_folder/page",["require","exports","tslib","classnames","react","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/browse/sort_helpers","modules/clean/react/css","modules/clean/react/async/loadable","modules/clean/em_string","modules/clean/react/open_in_app/banner","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/shared_link_folder/grid","modules/clean/react/shared_link_folder/list","modules/clean/react/shared_link_folder/view_toggle","modules/clean/react/takedown_warning","modules/clean/sharing/constants","modules/clean/web_timing_logger","modules/core/i18n","modules/clean/react/icon/icon_helper","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/app_download_interstitial/app_download_interstitial","modules/clean/react/shared_link_folder/folder_title","modules/core/i18n"],(function(e,r,t,n,a,i,o,l,s,d,c,u,f,p,_,m,h,v,g,w,y,b,k,S,F,E,T){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importDefault(n),a=t.__importDefault(a),g=t.__importStar(g);var P=d.Loadable({loader:function(){return new Promise((function(r,t){e(["modules/clean/react/shared_link_folder/title_bar"],r,t)})).then(t.__importStar).then((function(e){return e.SharedLinkFolderTitleBar}))}}),I=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.state={openInAppBannerClosed:!1},r.shouldShowOpenInAppBanner=function(){var e=r.props.folder,t=r.state.openInAppBannerClosed;return e&&e.open_in_app_data&&!t},r.onOpenInAppClosed=function(){r.setState({openInAppBannerClosed:!0})},r.onInterstitialClose=function(){S.logEvent(S.EventType.appDownloadInterstitialClose,r.props.folderPreviewSession),r.props.onAppDownloadInterstitialDismissed()},r.onInterstitialContinue=function(){S.logEvent(S.EventType.appDownloadInterstitialContinue,r.props.folderPreviewSession),r.props.onAppDownloadInterstitialDismissed()},r.onAppDownload=function(){S.logEvent(S.EventType.appDownloadInterstitialInstall,r.props.folderPreviewSession)},r.handleBreadcrumbClick=function(e){var n=r.props,a=n.breadcrumbs,i=n.folderPreviewSession;i.extra=t.__assign({},i.extra,{origin_breadcrumb:a.length-1,destination_breadcrumb:e}),S.logEvent(S.EventType.breadcrumbClicked,i)},r}return t.__extends(r,e),r.prototype.componentWillMount=function(){S.logEvent(S.EventType.attempted,this.props.folderPreviewSession)},r.prototype.componentWillUnmount=function(){S.logEvent(S.EventType.ended,this.props.folderPreviewSession)},r.prototype.componentDidMount=function(){this.ensureWebTimingMarked(),this.logSclTiming(),this.shouldShowAppDownloadInterstitial()&&S.logEvent(S.EventType.appDownloadInterstitialView,this.props.folderPreviewSession)},r.prototype.componentDidUpdate=function(){this.ensureWebTimingMarked()},r.prototype.componentDidCatch=function(){S.logEvent(S.EventType.renderFailed,this.props.folderPreviewSession)},r.prototype.shouldShowAppDownloadInterstitial=function(){var e=this.props,r=e.folder;return!e.appDownloadInterstitialDismissed&&r&&r.open_in_app_data},r.prototype.ensureWebTimingMarked=function(){var e=this.props,r=e.contents,t=r.files,n=r.folders,a=e.hasMore,i=e.webTimer;(t.length>0||n.length>0||!a)&&(i&&(i.timeToView()||i.markTimeToView(),i.timeToInteractive()||i.markTimeToInteractive()),S.markPrimaryEvent(this.props.folderPreviewSession),S.logEvent(S.EventType.renderSucceeded,this.props.folderPreviewSession))},r.prototype.logSclTiming=function(){if(this.props.user&&this.props.folderShareToken.linkType===v.SharedLinkType.Content){var e=(new Date).getTime(),r={ns_id:this.props.folder.shared_folder_id,timing:e-g.start_time()};i.ShareTibEventLogger.log(this.props.user.id,"PREVIEW_RENDER",v.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,r)}},r.prototype.render=function(){var e,r=this.props,t=r.accountMenuOptions,i=r.breadcrumbs,l=r.contents,s=r.folder,d=r.folderSharePermission,f=r.folderShareToken,p=r.folderSharedLinkInfo,_=r.hasMore,m=r.onFileOpen,v=r.onFolderOpen,g=r.onListModeDisable,w=r.onListModeEnable,y=r.outOfQuota,b=r.shouldForceListMode,S=r.showSyncCoachmark,T=r.sizeClass,I=r.takedownRequestType,D=r.user,C=a.default.createElement(E.FolderTitle,{title:c.Emstring.em_snippet(s.filename,T!==k.SizeClass.Small?35:20),ownerName:p.ownerName,ownerTeamName:p.ownerTeamName,ownerTeamLogo:p.ownerTeamLogo,breadcrumbs:i,onCrumbClick:this.handleBreadcrumbClick}),M=n.default("sl-page-body",{"view-in-app-bar-present":this.shouldShowOpenInAppBanner()});if(this.shouldShowAppDownloadInterstitial()){var L=p.displayName;e=a.default.createElement("div",{"aria-label":L},a.default.createElement(F.AppDownloadInterstitial,{isFolder:!0,fileOrFolderName:L,open_in_app_data:s.open_in_app_data,ownerName:p.ownerName,ownerTeamName:p.ownerTeamName,onClose:this.onInterstitialClose,onContinue:this.onInterstitialContinue,onAppDownload:this.onAppDownload}))}return a.default.createElement("div",null,a.default.createElement("div",{className:"sl-page-container"},a.default.createElement("div",{className:"sl-page-header"},a.default.createElement(P,{accountMenuOptions:t,folder:s,outOfQuota:y,sharedLinkInfo:p,shareToken:f,sharePermission:d,showSyncCoachmark:S,sizeClass:T,title:T===k.SizeClass.Small?C:void 0,user:D}),this.shouldShowOpenInAppBanner()?a.default.createElement(u.OpenInAppBanner,{urls:s.open_in_app_data,onClose:this.onOpenInAppClosed}):null),a.default.createElement("div",{className:M},a.default.createElement("div",{className:"sl-header clearfix"},a.default.createElement("h3",{className:"sl-title"},null!=I?a.default.createElement("div",{className:"sl-takedown-warning"},a.default.createElement(h.TakedownWarning,{takedownType:I})):null,T!==k.SizeClass.Small?C:null)),a.default.createElement(A,{files:l.files,folder:s,hasMore:_,shouldForceListMode:b,sizeClass:T,subfolders:l.folders,onListModeDisable:g,onListModeEnable:w,onFolderOpen:v,onFileOpen:m}),_?a.default.createElement("div",{className:"sl-loading-indicator"},a.default.createElement(o.LoadingIndicator,{style:o.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER})):null)),e)},r.defaultProps={shouldForceListMode:!1,webTimer:g.get_timer()},r})(a.default.PureComponent);r._SharedLinkFolderPage=I;var D=s.requireCssWithComponent(I,["/static/css/react_title_bar-vfletBR-r.css","/static/css/react_file_viewer-vfl1UuQe2.css"]),C=b.withSizeClass(D);r.SharedLinkFolderPage=C;function M(e,r){void 0===e&&(e=[]),void 0===r&&(r=[]);var t,n=(t=T.case_insensitive_comparator(!0),function(e,r){return l.compare(e.filename,r.filename,1,t)});return r.concat(e).sort(n)}function L(e){return a.default.createElement("div",{className:"sl-body sl-body--empty-folder"},a.default.createElement(f.SharedLinkFolderFolderIcon,{className:"sl-empty-folder-icon",folder:e.folder,size:y.SpectrumIconSize.Large}),a.default.createElement("h3",{className:"sl-empty-folder-message"},w._("This folder is empty")))}function A(e){var r=e.files,t=e.folder,n=e.hasMore,i=e.shouldForceListMode,o=e.sizeClass,l=e.subfolders,s=e.onFileOpen,d=e.onFolderOpen,c=M(r,l);return c.length||n?a.default.createElement("div",{className:"sl-body"},i?[a.default.createElement(_.SharedLinkFolderList,{key:"list",entries:c,sizeClass:o,onFolderOpen:d,onFileOpen:s}),a.default.createElement(m.FolderViewToggleOption,{key:"toggler",icon:"grid_light",label:w._("View as grid"),onClick:e.onListModeDisable})]:[a.default.createElement(p.SharedLinkFolderGrid,{key:"grid",entries:c,onFolderOpen:d,onFileOpen:s}),a.default.createElement(m.FolderViewToggleOption,{key:"toggler",icon:"list_light",label:w._("View as list"),onClick:e.onListModeEnable})]):a.default.createElement(L,{folder:t})}})),define("modules/clean/react/shared_link_folder/utils",["require","exports","tslib","modules/core/uri","modules/clean/history","modules/core/notify","modules/core/i18n","modules/clean/sharing/constants","modules/clean/viewer"],(function(e,r,t,n,a,i,o,l,s){"use strict";function d(e){var r=e._mount_access_perms;return null!=r&&!r.includes("can_view")}function c(e){var r=e.getPath();try{r=decodeURIComponent(r)}catch(e){}a.default.push_state(n.URI.encode_parts(r),e.getQuery())}function u(e,r){void 0===r&&(r=!1);var t=n.URI.parse(e);"lst"in a.default.get_uri().getQuery()&&t.updateQuery({lst:""}),r&&t.updateQuery({subfolder_nav_tracking:"1"}),c(t)}function f(e){return s.Viewer.get_viewer().is_signed_in?o._("%(folder_name)s - Dropbox").format({folder_name:e}):o._("Dropbox - %(folder_name)s - Simplify your life").format({folder_name:e})}function p(e,r,t,n){if(void 0===t&&(t=0),void 0===n&&(n=!1),!Array.isArray(r))return e||[];if(!r.length)return[];if(!Array.isArray(e))return r;var a=e.slice();return a.splice.apply(a,[t,r.length].concat(r)),n?a.slice(0,t+r.length):a}Object.defineProperty(r,"__esModule",{value:!0}),a=t.__importDefault(a),r.isNoAccessFolder=d,r.navigateToFolderHref=u,r.openFolder=function(e){d(e)?i.Notify.error(o._("Can’t open %(folder_name)s. Ask your admin for access.").format({folder_name:e.filename})):u(e.href,!0)},r.enableListMode=function(){(function(e,r){var t={};t[e]=r;var n=a.default.get_uri();n.updateQuery(t),c(n)})("lst","")},r.disableListMode=function(){var e,r;e="lst",(r=a.default.get_uri()).removeQuery(e),c(r)},r.getFolderShareTokenFromLocation=function(e){var r=e.path,t=l.SharedLinkType.Shmodel;"/sh"===r.substr(0,3)?(t=l.SharedLinkType.Shmodel,r=r.substring(4,r.length)):"/scl/fo"===r.substr(0,7)&&(t=l.SharedLinkType.Content,r=r.substring(8,r.length));var n=r.split("/");return{linkKey:n[0],linkType:t,secureHash:n[1],subPath:n.slice(2).join("/")}},r.shouldUpdateFolderHierarchy=function(e,r,t){var n=t.secureHash,a=t.subPath,i=r.secureHash,o=r.subPath;return!e[n]||a.startsWith(o)&&e[i].length>=e[n].length},r.generatePageTitle=f,r.setPageTitle=function(e){document.title=f(e)},r.mergeListChunk=p,r.mergeFolderEntries=p})),define("modules/clean/react/shared_link_folder/view_toggle",["require","exports","tslib","classnames","react","modules/clean/react/sprite"],(function(e,r,t,n,a,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importDefault(n),a=t.__importDefault(a),r.FolderViewToggleOption=function(e){var r=e.icon,t=e.label,o=e.onClick;return a.default.createElement("button",{"aria-label":t,className:n.default({"sl-view-toggle-option":!0}),name:t,onClick:o,value:t},a.default.createElement(i.Sprite,{group:"web",name:r,alt:t}))}})),define("modules/clean/react/takedown_warning",["require","exports","tslib","react","classnames","modules/clean/react_format","modules/constants/python","modules/core/i18n"],(function(e,r,t,n,a,i,o,l){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importDefault(n),a=t.__importDefault(a);r.TakedownWarning=function(e){var r=e.takedownType;return n.default.createElement("div",{className:a.default("notify","server-success")},(function(e){return e===o.TakedownRequestTypes.DMCA?i.reactFormat(l._("Certain files in this folder can’t be shared due to a takedown request in accordance with the DMCA. <a>Learn more</a>"),{a:n.default.createElement("a",{target:"_top",href:"/help/210"})}):i.reactFormat(l._("Certain files in this folder are unavailable. For more information <a>contact Dropbox support</a>."),{a:n.default.createElement("a",{target:"_top",href:"/ticket"})})})(r))},r.TakedownWarning.displayName="TakedownWarning"})),define("modules/clean/react/thumbnail",["require","exports","tslib","classnames","react","modules/clean/photos/batching_thumb_store","spectrum/file_icon","modules/constants/python","modules/core/uri","modules/clean/file_store/utils"],(function(e,r,t,n,a,i,o,l,s,d){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),n=t.__importDefault(n),a=t.__importDefault(a),i=t.__importDefault(i);var c=i.default(),u=(function(e){function r(r){var t=e.call(this,r)||this;return t.bindingId=null,t.handleImageError=function(){t.setState({src:null})},t.state=t.getStateForTemplateUrl(t.props.file.thumbnail_url_tmpl),t}return t.__extends(r,e),r.prototype.componentDidMount=function(){this.bindThumbStore()},r.prototype.componentWillReceiveProps=function(e){var r=e.file.thumbnail_url_tmpl;r!==this.props.file.thumbnail_url_tmpl&&this.setState(this.getStateForTemplateUrl(r))},r.prototype.componentWillUpdate=function(){this.unbindThumbStore()},r.prototype.componentDidUpdate=function(){this.bindThumbStore()},r.prototype.componentWillUnmount=function(){this.unbindThumbStore()},r.prototype.bindThumbStore=function(){var e=this;if(this.state.isLoading&&!this.bindingId){var r=this.state.url;r&&(this.bindingId=c.bind_url(r,{onSuccess:function(){e.setState({isLoading:!1,src:c.get_thumb(r)})},onError:function(){e.setState({isLoading:!1})}}))}},r.prototype.unbindThumbStore=function(){this.bindingId&&(c.unbind_url(this.bindingId),this.bindingId=null)},r.prototype.getStateForTemplateUrl=function(e){var t=null;if(!e)return{isLoading:!1,src:null};var n=r.getThumbnailUrl(e);return n&&(t=c.get_thumb(n)),{isLoading:!!n&&!t,src:t,url:n}},r.getThumbnailUrl=function(e){if(e){var r=s.URI.parse(e);return r.updateQuery("size","178x178"),r.updateQuery("size_mode",l.THUMBNAIL_SIZE_MODE.EXACT.toString()),r.toString()}},r.prototype.render=function(){var e,r=this.props,t=r.alt,i=r.file,l=r.iconSize,s=r.className,c=this.state.src;return c?(e=["icon","thumbnail-image--loaded",s],a.default.createElement("img",{alt:t,className:n.default(e),src:c,onError:this.handleImageError})):(e=["icon","thumbnail-image--failed",s],a.default.createElement(o.FileIcon,{className:n.default(e),path:d.getFilename(i),variant:l}))},r.displayName="ThumbnailIcon",r})(a.default.Component);r.ThumbnailIcon=u}));
//# sourceMappingURL=pkg-shared_link_folder.min.js-vflAPzRZC.map